<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>IT日记</title>
  
  <subtitle>Life is Now.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-11-05T05:54:55.843Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Breeze.Temple</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>x96maxplus</title>
    <link href="http://yoursite.com/2020/11/05/x96maxplus/"/>
    <id>http://yoursite.com/2020/11/05/x96maxplus/</id>
    <published>2020-11-05T05:11:44.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>X96MAX+ 折腾记录</p><ul><li>ATV + CoreELEC</li><li>OpenWrt</li></ul><a id="more"></a><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><ul><li>ATV + CoreELEC<ul><li><a href="http://www.tvboxfactory.com/index.php?m=home&c=View&a=index&aid=108" target="_blank" rel="noopener">ATV固件，S905X2,和S905X3芯片通用的-X96 MAX机器固件</a></li><li><a href="https://forum.freaktab.com/forum/tv-player-support/amlogic-based-tv-players/s905x3" target="_blank" rel="noopener">S905X3</a></li><li><a href="https://forum.freaktab.com/forum/tv-player-support/amlogic-based-tv-players/s905x3/firmware-roms-tools-ds" target="_blank" rel="noopener">FIRMWARE - ROMS - TOOLS</a></li><li><a href="https://chinagadgetsreviews.com/download-android-pie-9-0-firmware-for-x96-max-plus2-tv-box-2.html" target="_blank" rel="noopener">Download Android Pie 9.0 firmware for X96 Max Plus2 TV Box</a></li><li><a href="https://post.smzdm.com/p/a99v2q35/" target="_blank" rel="noopener">x96max+ 盒子 与 CoreELEC系统配置（一）：红外遥控开关机与VFD屏幕显示</a></li><li><a href="https://post.smzdm.com/p/alpw279e/" target="_blank" rel="noopener">x96max+ 盒子 与 CoreELEC系统配置（二）：emmc双系统+ 流光溢彩</a></li><li><a href="https://post.smzdm.com/p/aeke4xm4/" target="_blank" rel="noopener">x96max+ 盒子 与 CoreELEC系统配置（三）AndroidTV刷机记录</a></li><li><a href="https://4pda.ru/forum/index.php?showtopic=972364" target="_blank" rel="noopener">4PDA X96max+</a></li><li><a href="https://www.getdroidtips.com/stock-firmware-x96-max-plus-tv-box/#Instructions-to-Install" target="_blank" rel="noopener">How to Install Stock Firmware on X96 Max Plus TV Box [Android 9.0]</a></li><li><a href="https://gitee.com/s0xff/CoreELEC_Test/tree/master" target="_blank" rel="noopener">CoreELEC_Test</a></li><li><a href="https://www.rosnas.com/1645.html" target="_blank" rel="noopener">x96 max+外贸盒子改散热,刷ATV,CoreELEC系统</a></li></ul></li><li>OpenWrt<ul><li><a href="https://www.right.com.cn/forum/thread-4055451-1-1.html" target="_blank" rel="noopener">[2020-10-29] 47+O S905x3(含x2)、N1、贝壳云、我家云等OP固件</a></li><li><a href="https://www.right.com.cn/forum/thread-981406-1-1.html" target="_blank" rel="noopener">[N1盒子] [2020-10-18]★46+o版， S905x3、N1、贝壳云、我家云等op固件</a></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;X96MAX+ 折腾记录&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ATV + CoreELEC&lt;/li&gt;
&lt;li&gt;OpenWrt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Hacker" scheme="http://yoursite.com/categories/Hacker/"/>
    
      <category term="S905X3" scheme="http://yoursite.com/categories/Hacker/S905X3/"/>
    
    
      <category term="ATV" scheme="http://yoursite.com/tags/ATV/"/>
    
      <category term="CoreELEC" scheme="http://yoursite.com/tags/CoreELEC/"/>
    
  </entry>
  
  <entry>
    <title>ld 选项 -warn-common</title>
    <link href="http://yoursite.com/2020/11/04/ld-warn-common/"/>
    <id>http://yoursite.com/2020/11/04/ld-warn-common/</id>
    <published>2020-11-04T08:28:58.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p><code>-warn-common</code> 选项分析</p><a id="more"></a><h2 id="编译警告"><a href="#编译警告" class="headerlink" title="编译警告"></a>编译警告</h2><pre><code>libtest.a(rmdec.c.o): warning: definition of `sipr_subpk_size&#39; overriding commonlibtest.a(matroskadec.c.o): warning: common is herelibtest.a(rdt.c.o): warning: common of `sipr_subpk_size&#39; overridden by definitionlibtest.a(rmdec.c.o): warning: defined here</code></pre><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><ul><li><a href="https://stackoverflow.com/questions/2331584/global-variable-implementation" target="_blank" rel="noopener">Global variable implementation</a></li><li><a href="https://stackoverflow.com/questions/11958626/make-file-warning-overriding-commands-for-target" target="_blank" rel="noopener">Make file warning, overriding commands for target</a></li></ul><p>代码编写存在风险</p><ul><li>修改源码，去除编译警告</li><li>去除 <code>-warn-common</code> 不生成编译警告</li></ul><p><a href="https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_node/ld_3.html" target="_blank" rel="noopener">Ld Command Line Options</a></p><blockquote><p>Warn when a common symbol is combined with another common symbol or with a symbol definition. Unix linkers allow this somewhat sloppy practice, but linkers on some other operating systems do not. This option allows you to find potential problems from combining global symbols. Unfortunately, some C libraries use this practice, so you may get some warnings about symbols in the libraries as well as in your programs. There are three kinds of global symbols, illustrated here by C examples:</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;-warn-common&lt;/code&gt; 选项分析&lt;/p&gt;
    
    </summary>
    
      <category term="C" scheme="http://yoursite.com/categories/C/"/>
    
      <category term="Linker" scheme="http://yoursite.com/categories/C/Linker/"/>
    
    
      <category term="ld" scheme="http://yoursite.com/tags/ld/"/>
    
      <category term="c" scheme="http://yoursite.com/tags/c/"/>
    
      <category term="linker" scheme="http://yoursite.com/tags/linker/"/>
    
  </entry>
  
  <entry>
    <title>Pandoc 定制模板转换 Markdown 为 PDF</title>
    <link href="http://yoursite.com/2020/11/02/customizing-pandoc/"/>
    <id>http://yoursite.com/2020/11/02/customizing-pandoc/</id>
    <published>2020-11-02T06:35:43.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>定制模板控制 <code>Markdown</code> 转换细节</p><a id="more"></a><h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p><a href="https://github.com/Wandmalfarbe/pandoc-latex-template.git" target="_blank" rel="noopener">Eisvogel</a></p><p>使用 Metadata 控制</p><h2 id="Pandoc-Filter"><a href="#Pandoc-Filter" class="headerlink" title="Pandoc Filter"></a>Pandoc Filter</h2><p>扩展 <code>Markdown</code></p><ol><li><a href="https://github.com/timofurrer/pandoc-mermaid-filter" target="_blank" rel="noopener">pandoc-mermaid-filter</a></li><li><a href="https://github.com/raghur/mermaid-filter" target="_blank" rel="noopener">mermaid-filter</a></li><li><a href="https://github.com/taqenoqo/pandoc-ditaa-filter" target="_blank" rel="noopener">Pandoc Ditaa Filter</a></li><li><a href="https://github.com/hertogp/imagine" target="_blank" rel="noopener"><strong>Imagine</strong></a></li></ol><p>其中 <code>Imagine</code> 支持如下代码块</p><ul><li>asy</li><li>blockdiag</li><li>boxes</li><li>chartdirector</li><li>ctioga2</li><li>ditaa</li><li>figlet</li><li>flydraw</li><li>gle</li><li>gnuplot</li><li>graphviz</li><li>gri</li><li>inline</li><li>matplotlib</li><li>mermaid</li><li>mscgen</li><li>octave</li><li>plantuml</li><li>ploticus</li><li>plotutils</li><li>protocol</li><li>pygal</li><li>pyxplot</li><li>random</li><li>sample</li><li>wolfram</li></ul><h2 id="Pandoc-控制"><a href="#Pandoc-控制" class="headerlink" title="Pandoc 控制"></a>Pandoc 控制</h2><ul><li>模板即为一组语法集合</li><li>转换为 PDF <code>--pdf-engine=xelatex</code></li><li>使用模板 <code>--template &quot;eisvogel.latex&quot;</code></li></ul><h3 id="支持中文"><a href="#支持中文" class="headerlink" title="支持中文"></a>支持中文</h3><p><code>-V CJKmainfont=&quot;Microsoft YaHei&quot;</code></p><h3 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h3><ul><li><code>--list-highlight-styles</code></li><li><code>--list-highlight-languages</code></li><li><code>--highlight-style zenburn</code></li></ul><p>定制语法高亮，输出默认并编辑</p><pre><code class="shell">$ pandoc --print-highlight-style=pygments &gt; pygments.theme</code></pre><h3 id="章节编号"><a href="#章节编号" class="headerlink" title="章节编号"></a>章节编号</h3><p><code>--number-sections</code></p><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul><li><code>--toc</code></li><li><code>--toc-depth</code></li><li><code>-V toc-title</code></li></ul><h3 id="链接颜色"><a href="#链接颜色" class="headerlink" title="链接颜色"></a>链接颜色</h3><p><code>-V colorlinks -V urlcolor=NavyBlue</code></p><h3 id="PDF-margin"><a href="#PDF-margin" class="headerlink" title="PDF margin"></a>PDF margin</h3><p><code>-V geometry:&quot;top=2cm, bottom=1.5cm, left=2cm, right=2cm&quot;</code></p><h3 id="设置放入-head-tex"><a href="#设置放入-head-tex" class="headerlink" title="设置放入 head.tex"></a>设置放入 head.tex</h3><p><code>-H --include-in-header=FILE</code></p><h3 id="Chapter-breaks"><a href="#Chapter-breaks" class="headerlink" title="Chapter breaks"></a>Chapter breaks</h3><pre><code class="latex">\usepackage{sectsty}\sectionfont{\clearpage}</code></pre><pre><code class="shell">$ $ pandoc sample_1.md -f gfm -H chapter_break.tex -o sample_1_chapter_break.pdf</code></pre><h3 id="Changing-settings-via-V-option"><a href="#Changing-settings-via-V-option" class="headerlink" title="Changing settings via -V option"></a>Changing settings via -V option</h3><pre><code class="shell">pandoc &quot;$1&quot; \    -f gfm \    --include-in-header chapter_break.tex \    -V linkcolor:blue \    -V geometry:a4paper \    -V geometry:margin=2cm \    -V mainfont=&quot;DejaVu Serif&quot; \    -V monofont=&quot;DejaVu Sans Mono&quot; \    --pdf-engine=xelatex \    -o &quot;$2&quot;</code></pre><ul><li><code>mainfont</code> is for normal text</li><li><code>monofont</code> is for code snippets</li><li><code>geometry</code> for page size and margins</li><li><code>linkcolor</code> to set hyperlink color</li></ul><h3 id="Inline-code"><a href="#Inline-code" class="headerlink" title="Inline code"></a>Inline code</h3><pre><code class="latex">\usepackage{fancyvrb,newverbs,xcolor}\definecolor{Light}{HTML}{F4F4F4}\let\oldtexttt\texttt\renewcommand{\texttt}[1]{  \colorbox{Light}{\oldtexttt{#1}}}</code></pre><p>使用方式<code>--include-in-header inline_code.tex</code></p><h3 id="PDF-properties"><a href="#PDF-properties" class="headerlink" title="PDF properties"></a>PDF properties</h3><pre><code class="latex">\usepackage{hyperref}\hypersetup{  pdftitle={My awesome book},  pdfauthor={learnbyexample},  pdfsubject={pandoc},  pdfkeywords={pandoc,pdf,xelatex}}</code></pre><h3 id="cover-image"><a href="#cover-image" class="headerlink" title="cover image"></a>cover image</h3><pre><code class="latex">\includegraphics{cover.png}\thispagestyle{empty}</code></pre><h3 id="blockquote"><a href="#blockquote" class="headerlink" title="blockquote"></a>blockquote</h3><pre><code class="latex">\usepackage{tcolorbox}\newtcolorbox{myquote}{colback=red!5!white, colframe=red!75!black}\renewenvironment{quote}{\begin{myquote}}{\end{myquote}}</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;定制模板控制 &lt;code&gt;Markdown&lt;/code&gt; 转换细节&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Markdown" scheme="http://yoursite.com/categories/Tools/Markdown/"/>
    
    
      <category term="markdown" scheme="http://yoursite.com/tags/markdown/"/>
    
      <category term="pandoc" scheme="http://yoursite.com/tags/pandoc/"/>
    
      <category term="latex" scheme="http://yoursite.com/tags/latex/"/>
    
      <category term="pandoc filter" scheme="http://yoursite.com/tags/pandoc-filter/"/>
    
  </entry>
  
  <entry>
    <title>Markdown 转换为 PDF 文档</title>
    <link href="http://yoursite.com/2020/10/30/convert-markdown-to-pdf/"/>
    <id>http://yoursite.com/2020/10/30/convert-markdown-to-pdf/</id>
    <published>2020-10-30T02:27:58.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>记录将 <code>Markdown</code> 转换为 <code>PDF</code> 过程</p><ul><li>GitBook 整体/部分/单章导出</li><li>Pandoc 导出 </li><li>Typora 导出</li><li>VSCode MPE 导出</li></ul><a id="more"></a><h2 id="GitBook"><a href="#GitBook" class="headerlink" title="GitBook"></a>GitBook</h2><p>支持安装插件以扩展功能，例如：</p><ul><li>flowchart.js</li><li>mermaid.js</li><li>UML绘图</li></ul><p>使用上述插件后，<code>Markdown</code> 在原生基础上做出了扩展，是超集</p><p><code>GitBook</code> 使用命令 <code>gitbook pdf</code> 导出电子书，其目录及内容依赖于比选项 <code>SUMMARY.md</code>。因此导出部分/单章内容时需要修改 <code>SUMMARY.md</code> 以满足需求。导出转换流程 <code>Markdown源码</code> -&gt; <code>HTML资源</code> -&gt; <code>PDF</code>，因此影响 <code>HTML</code> 的相关插件对最终输出效果均有影响。</p><p><code>README.md</code> 为比选项，因此导出单章时需要将内容重命名为 <code>README.md</code> 以避免引入 <code>introduction</code> 章节。</p><h2 id="Pandoc"><a href="#Pandoc" class="headerlink" title="Pandoc"></a>Pandoc</h2><p>使用模板 <a href="https://github.com/Wandmalfarbe/pandoc-latex-template.git" target="_blank" rel="noopener">Eisvogel</a></p><p>在文档中增加元数据</p><pre><code class="markdown">---title: &quot;DSM-CC&quot;author: Breezedate: &quot;2020-02-20&quot;subject: &quot;Markdown&quot;keywords: [Markdown, Example]table-use-row-colors: falsetoc-own-page: trueheader-left: &quot;National&quot;titlepage: true,titlepage-text-color: &quot;000000&quot;titlepage-rule-color: &quot;360049&quot;titlepage-rule-height: 0titlepage-background: &quot;titlepage-background/backgrounds/background1.pdf&quot;logo-width: 120...</code></pre><pre><code class="shell">$ pandoc &quot;index.md&quot; -o &quot;chinese.pdf&quot; --from markdown --template &quot;../eisvogel.latex&quot; --listings --pdf-engine=xelatex -V CJKmainfont=&quot;Microsoft YaHei&quot; --number-sections --toc</code></pre><blockquote><p>如果 Markdown 源码存在扩展会导致这部分输出异常，例如 GitBook 中插件部分扩展。优点是可以方便定制 LaTeX 模板</p></blockquote><p>扩展：</p><ul><li><a href="http://pages.tzengyuxio.me/pandoc/" target="_blank" rel="noopener">Pandoc’s Markdown 語法中文翻譯</a></li><li><a href="https://texblog.org/2011/01/27/add-your-logo-to-the-title-page/" target="_blank" rel="noopener">Title Page 增加 Logo</a></li><li><a href="https://zhuanlan.zhihu.com/p/81704534" target="_blank" rel="noopener">如何使用 Pandoc 和 LaTeX 制作漂亮的 pdf</a></li><li><a href="https://pandoc.org/MANUAL.html#general-options" target="_blank" rel="noopener">Pandoc General options</a></li><li><a href="https://learnbyexample.github.io/customizing-pandoc/" target="_blank" rel="noopener">Customizing pandoc to generate beautiful pdf and epub from markdown</a></li><li><a href="https://gowa.club/macOS/%E4%BD%BF%E7%94%A8pandoc%E8%BD%AC%E6%8D%A2pdf%E4%B8%8Edocx%E5%8A%A0%E4%B8%8A%E4%B9%A6%E7%AD%BE%E7%9B%AE%E5%BD%95.html" target="_blank" rel="noopener">使用pandoc转换pdf与docx加上书签目录</a></li><li><a href="https://yijiebuyi.com/blog/17e31502e8a6229a18971a2499f0e72b.html" target="_blank" rel="noopener">pandoc markdown 生成pdf文档</a></li><li><a href="https://jdhao.github.io/2017/12/10/pandoc-markdown-with-chinese/" target="_blank" rel="noopener">使用 Pandoc 把 Markdown 转为 PDF 文件</a></li><li><a href="http://www.biexiaoyu1994.com/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/2019/10/21/latex_summary/" target="_blank" rel="noopener">LaTex 语法总结</a></li><li><a href="https://www.latextemplates.com/" target="_blank" rel="noopener">LaTeX Templates</a></li><li><a href="https://uoftcoders.github.io/studyGroup/lessons/misc/pandoc-intro/lesson/" target="_blank" rel="noopener">How to use Pandoc and Markdown for writing scientific manuscripts</a></li><li><a href="https://afoo.me/posts/2013-07-10-how-to-transform-chinese-pdf-with-pandoc.html" target="_blank" rel="noopener">pandoc中文pdf转换攻略</a></li></ul><h2 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h2><p>所见即所得，方便本地编辑导出 PDF</p><h2 id="VSCode"><a href="#VSCode" class="headerlink" title="VSCode"></a>VSCode</h2><p>基于插件 <a href="https://shd101wyy.github.io/markdown-preview-enhanced/#/zh-cn/pandoc-pdf" target="_blank" rel="noopener">MPE Pandoc</a> 本地编辑导出 PDF</p><p>TODOs</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;记录将 &lt;code&gt;Markdown&lt;/code&gt; 转换为 &lt;code&gt;PDF&lt;/code&gt; 过程&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GitBook 整体/部分/单章导出&lt;/li&gt;
&lt;li&gt;Pandoc 导出 &lt;/li&gt;
&lt;li&gt;Typora 导出&lt;/li&gt;
&lt;li&gt;VSCode MPE 导出&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Markdown" scheme="http://yoursite.com/categories/Tools/Markdown/"/>
    
    
      <category term="markdown" scheme="http://yoursite.com/tags/markdown/"/>
    
      <category term="pandoc" scheme="http://yoursite.com/tags/pandoc/"/>
    
      <category term="gitbook" scheme="http://yoursite.com/tags/gitbook/"/>
    
      <category term="latex" scheme="http://yoursite.com/tags/latex/"/>
    
      <category term="texlive" scheme="http://yoursite.com/tags/texlive/"/>
    
  </entry>
  
  <entry>
    <title>BookStack 填坑指南</title>
    <link href="http://yoursite.com/2020/09/29/how-to-install-bookstack/"/>
    <id>http://yoursite.com/2020/09/29/how-to-install-bookstack/</id>
    <published>2020-09-29T02:36:42.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>安装 BookStack 过程中遇到的问题及解决方案</p><a id="more"></a><h2 id="安装指南"><a href="#安装指南" class="headerlink" title="安装指南"></a>安装指南</h2><ol><li><a href="https://www.howtoforge.com/how-to-install-bookstack-on-ubuntu-1804/" target="_blank" rel="noopener">How to Install BookStack on Ubuntu 18.04 LTS</a><ul><li>MariaDB</li></ul></li><li><a href="https://www.bookstackapp.com/docs/admin/installation/#ubuntu-1804" target="_blank" rel="noopener">Ubuntu 18.04 Installation Script</a><ul><li>MySQL</li></ul></li></ol><p>采用 <code>MySQL</code> 管理数据</p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p>执行如下命令失败：</p><pre><code class="shell">mysql -u root --execute=&quot;CREATE DATABASE bookstack;&quot;mysql -u root --execute=&quot;CREATE USER &#39;bookstack&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;$DB_PASS&#39;;&quot;mysql -u root --execute=&quot;GRANT ALL ON bookstack.* TO &#39;bookstack&#39;@&#39;localhost&#39;;FLUSH PRIVILEGES;&quot;</code></pre><p><a href="https://stackoverflow.com/questions/37879448/mysql-fails-on-mysql-error-1524-hy000-plugin-auth-socket-is-not-loaded" target="_blank" rel="noopener">MySQL fails on: mysql “ERROR 1524 (HY000): Plugin ‘auth_socket’ is not loaded”</a></p><ul><li><p>I</p><pre><code class="shell">  $ sudo /etc/init.d/mysql stop # stop mysql service  $ sudo mysqld_safe --skip-grant-tables &amp; # start mysql without password  # enter -&gt; go  $ mysql -uroot # connect to mysql</code></pre></li><li><p>Socket issue: ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/run/mysqld/mysqld.sock’</p><pre><code class="shell">  $ sudo mkdir -p /var/run/mysqld; sudo chown mysql /var/run/mysqld  $ sudo mysqld_safe --skip-grant-tables &amp;</code></pre></li><li><p>run mysql commands =&gt; copy paste this to cli manually</p><pre><code class="mysql">  use mysql; # use mysql table  update user set authentication_string=PASSWORD(&quot;&quot;) where User=&#39;root&#39;; # update password to nothing  update user set plugin=&quot;mysql_native_password&quot; where User=&#39;root&#39;; # set password resolving to default mechanism for root user  flush privileges;  quit;</code></pre></li><li><p>F</p><pre><code class="shell">  $ sudo /etc/init.d/mysql stop  $ sudo /etc/init.d/mysql start # reset mysql  # try login to database, just press enter at password prompt because your password is now blank  $ mysql -u root -p</code></pre></li></ul><p><a href="https://stackoverflow.com/questions/44096710/error-1728-hy000-cannot-load-from-mysql-user-the-table-is-probably-corrupted" target="_blank" rel="noopener">ERROR 1728 (HY000): Cannot load from mysql.user. The table is probably corrupted</a></p><pre><code class="shell">$ mysql_upgrade -uroot -p --force</code></pre><p><a href="https://stackoverflow.com/questions/43846950/column-count-of-mysql-user-is-wrong-expected-42-found-44-the-table-is-probabl" target="_blank" rel="noopener">Column count of mysql.user is wrong. Expected 42, found 44. The table is probably corrupted</a></p><pre><code class="shell">$ mysql -u root -pmysql&gt; use mysql;mysql&gt; alter table mysql.user drop column default_role;mysql&gt; alter table mysql.user drop column max_statement_time;mysql&gt; alter table mysql.user drop column password_expired;mysql&gt; quit;</code></pre><p>手动执行上述三条语句，创建成功</p><h2 id="composer"><a href="#composer" class="headerlink" title="composer"></a>composer</h2><p>部分需要访问 <code>github.com</code> 导致安装失败</p><pre><code class="shell">$ sudo composer config repo.packagist composer https://mirrors.aliyun.com/composer/$ sudo composer install</code></pre><h2 id="Apache2"><a href="#Apache2" class="headerlink" title="Apache2"></a>Apache2</h2><p>启动失败，原因是 <code>80</code> 端口被占用</p><pre><code class="shell">$ sudo netstat -ltnp | grep &#39;:80&#39;$ sudo lsof -i :80$ sudo systemctl stop nginx.service</code></pre><h2 id="wkhtmltopdf"><a href="#wkhtmltopdf" class="headerlink" title="wkhtmltopdf"></a>wkhtmltopdf</h2><ul><li><a href="https://www.bookstackapp.com/docs/admin/pdf-rendering/" target="_blank" rel="noopener">PDF Rendering</a></li><li><a href="https://gist.github.com/lobermann/ca0e7bb2558b3b08923c6ae2c37a26ce" target="_blank" rel="noopener">Install wkhtmltopdf on headless ubuntu 18 vps</a></li></ul><p>手动安装最新版本</p><pre><code class="shell">$ wget https://downloads.wkhtmltopdf.org/0.12/0.12.5/wkhtmltox_0.12.5-1.bionic_amd64.deb$ apt-get install fontconfig libxrender1 xfonts-75dpi xfonts-base$ dpkg -i wkhtmltox_0.12.5-1.bionic_amd64.deb</code></pre><p>测试</p><pre><code class="shell">$ wkhtmltopdf http://www.baidu.com baidu.pdf</code></pre><p><a href="https://github.com/BookStackApp/BookStack/issues/885" target="_blank" rel="noopener">ProcessTimedOutException when exporting with wkhtmltopdf</a><br><code>BookStack</code> 导出携带不存在图片文章时出错，修改 <code>BookStack/config/snappy.php</code> 中超时 <code>timeout</code> 为 3600</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;安装 BookStack 过程中遇到的问题及解决方案&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="CI" scheme="http://yoursite.com/categories/Tools/CI/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
      <category term="bookstack" scheme="http://yoursite.com/tags/bookstack/"/>
    
      <category term="wkhtmltopdf" scheme="http://yoursite.com/tags/wkhtmltopdf/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu 安装 Pandoc 和 TeX Live</title>
    <link href="http://yoursite.com/2020/09/27/pandoc-with-texlive/"/>
    <id>http://yoursite.com/2020/09/27/pandoc-with-texlive/</id>
    <published>2020-09-27T09:35:18.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>ubuntu18.04 下 <code>pandoc</code> + <code>LaTeX</code> 将 <code>markdown</code> 转为 <code>pdf</code></p><a id="more"></a><h2 id="Pandoc"><a href="#Pandoc" class="headerlink" title="Pandoc"></a>Pandoc</h2><pre><code class="shell">$ sudo dpkg -r pandoc$ sudo apt purge pandoc$ wget https://github.com/jgm/pandoc/releases/download/2.10.1/pandoc-2.10.1-1-amd64.deb$ sudo dpkg -i pandoc-2.10.1-1-amd64.deb$ sudo apt install xzdec</code></pre><h2 id="TeX-Live"><a href="#TeX-Live" class="headerlink" title="TeX Live"></a>TeX Live</h2><p><code>TeX Live</code> 是 <code>LaTeX</code> 的发行版，<code>tlmgr</code> 用于管理安装后的程序，包管理器</p><h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><pre><code class="shell">$ sudo apt purge texlive*$ sudo rm -rf /usr/local/texlive/* and rm -rf ~/.texlive*$ sudo rm -rf /usr/local/share/texmf$ sudo rm -rf /var/lib/texmf$ sudo rm -rf /etc/texmf$ sudo apt remove tex-common --purge$ rm -rf ~/.texlive$ find -L /usr/local/bin/ -lname /usr/local/texlive/*/bin/* | sudo xargs rm</code></pre><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="apt"><a href="#apt" class="headerlink" title="apt"></a>apt</h4><pre><code class="shell">$ sudo apt install texlive-full</code></pre><h4 id="sh"><a href="#sh" class="headerlink" title="sh"></a>sh</h4><ol><li>安装<pre><code>$ wget https://mirrors.nju.edu.cn/CTAN/systems/texlive/tlnet/install-tl.zip$ sudo perl install-tl</code></pre></li><li>配置环境 <code>~/.zshrc</code><pre><code>export PATH=$PATH:/usr/local/texlive/2020/bin/x86_64-linuxexport MANPATH=/usr/local/texlive/2020/texmf-dist/doc/manexport INFOPATH=/usr/local/texlive/2020/texmf-dist/doc/info</code></pre></li><li>-设置字体- 导致乱码<pre><code class="shell">$ sudo cp /usr/local/texlive/2020/texmf-var/fonts/conf/texlive-fontconfig.conf /etc/fonts/conf.d/09-texlive.conf$ sudo fc-cache -fv</code></pre></li></ol><p>$ sudo rm sudo fc-cache -fv<br>$ sudo fc-cache -fv</p><pre><code>4. 更新为国内源，可选```shell$ sudo visudo# add /usr/local/texlive/2020/bin/x86_64-linux to secure_path$ sudo tlmgr option repository https://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet</code></pre><ol start="5"><li>更新<pre><code class="shell">$ sudo tlmgr update --list$ sudo tlmgr update --self --all</code></pre></li></ol><h2 id="Editor"><a href="#Editor" class="headerlink" title="Editor"></a>Editor</h2><p>vscode <code>LaTeX Workshop</code></p><h2 id="Eisvogel"><a href="#Eisvogel" class="headerlink" title="Eisvogel"></a>Eisvogel</h2><p><a href="https://github.com/Wandmalfarbe/pandoc-latex-template" target="_blank" rel="noopener">Eisvogel</a></p><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ol><li><a href="https://matnoble.me/tech/ubuntu/install-texlive/" target="_blank" rel="noopener">Windows + Ubuntu 安装配置更新卸载 TeXLive 指南</a></li><li><a href="https://tug.org/texlive/quickinstall.html" target="_blank" rel="noopener">TeX Live - Quick install</a></li><li><a href="https://zhuanlan.zhihu.com/p/136931926" target="_blank" rel="noopener">TeX Live 2020 安装指南</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ubuntu18.04 下 &lt;code&gt;pandoc&lt;/code&gt; + &lt;code&gt;LaTeX&lt;/code&gt; 将 &lt;code&gt;markdown&lt;/code&gt; 转为 &lt;code&gt;pdf&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Markdown" scheme="http://yoursite.com/categories/Tools/Markdown/"/>
    
    
      <category term="markdown" scheme="http://yoursite.com/tags/markdown/"/>
    
      <category term="pandoc" scheme="http://yoursite.com/tags/pandoc/"/>
    
      <category term="latex" scheme="http://yoursite.com/tags/latex/"/>
    
      <category term="texlive" scheme="http://yoursite.com/tags/texlive/"/>
    
  </entry>
  
  <entry>
    <title>更新最新版本 USB ID List</title>
    <link href="http://yoursite.com/2020/09/24/ubuntu-update-usbids/"/>
    <id>http://yoursite.com/2020/09/24/ubuntu-update-usbids/</id>
    <published>2020-09-24T07:19:39.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>同步最新版本 USB ID List，用于识别设备</p><pre><code class="shell">$ sudo update-usbids$ lsusb</code></pre><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;同步最新版本 USB ID List，用于识别设备&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;shell&quot;&gt;$ sudo update-usbids
$ lsusb&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="ubuntu" scheme="http://yoursite.com/categories/ubuntu/"/>
    
    
      <category term="ubuntu" scheme="http://yoursite.com/tags/ubuntu/"/>
    
      <category term="usb" scheme="http://yoursite.com/tags/usb/"/>
    
  </entry>
  
  <entry>
    <title>Gerrit 配置权限禁止直接 push</title>
    <link href="http://yoursite.com/2020/09/23/gerrit-disable-direct-push-and-allow-gerrit-push/"/>
    <id>http://yoursite.com/2020/09/23/gerrit-disable-direct-push-and-allow-gerrit-push/</id>
    <published>2020-09-23T06:58:29.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>配置 Gerrit 权限禁止直接 push 代码到仓库</p><a id="more"></a><p>关于 Gerrit Push 权限描述如下：</p><blockquote><p>This category controls how users are allowed to upload new commits to projects in Gerrit. It can either give permission to push directly into a branch, bypassing any code review process that would otherwise be used. Or it may give permission to upload new changes for code review, this depends on which namespace the permission is granted to.</p></blockquote><p>具体权限配置与 namespace 有关</p><ul><li><code>refs/for/*</code> 代码评审</li><li><code>refs/head/*</code> 直接提交</li><li><code>refs/tags/*</code> tag</li></ul><p>配置如下：</p><ul><li>Reference: <code>refs/for/*</code><ul><li>Read: ALLOW</li><li>Push: ALLOW</li><li>Push Merge Commit: ALLOW</li></ul></li><li>Reference: <code>refs/heads/*</code><ul><li>Read: ALLOW</li><li>Push: BLOCK</li><li>Label Code-Review: -1 +1</li></ul></li><li>Reference: <code>refs/tags/*</code><ul><li>Push: ALLOW</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;配置 Gerrit 权限禁止直接 push 代码到仓库&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Gerrit" scheme="http://yoursite.com/categories/Tools/Gerrit/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
      <category term="gerrit" scheme="http://yoursite.com/tags/gerrit/"/>
    
  </entry>
  
  <entry>
    <title>Jenkins中安装Node.js</title>
    <link href="http://yoursite.com/2020/09/17/jenkins-nodejs/"/>
    <id>http://yoursite.com/2020/09/17/jenkins-nodejs/</id>
    <published>2020-09-17T02:51:05.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>Jenkins中安装指定版本Node.js</p><a id="more"></a><h2 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h2><ul><li><code>Manage Jenkins</code></li><li><code>Manage Plugins</code></li><li>Install <code>NodeJS</code></li></ul><h2 id="插件配置"><a href="#插件配置" class="headerlink" title="插件配置"></a>插件配置</h2><ul><li><code>Manage Jenkins</code></li><li><code>Global Tool Configuration</code></li><li><code>NodeJS</code><ul><li>别名</li><li>版本</li></ul></li></ul><h2 id="Job使用"><a href="#Job使用" class="headerlink" title="Job使用"></a>Job使用</h2><ul><li>新建Job</li><li>构建环境</li><li>Provide Node &amp; npm bin/ folder to PATH</li><li>选择别名</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Jenkins中安装指定版本Node.js&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="CI" scheme="http://yoursite.com/categories/Tools/CI/"/>
    
    
      <category term="jenkins" scheme="http://yoursite.com/tags/jenkins/"/>
    
      <category term="nodejs" scheme="http://yoursite.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>字符集与字符编码</title>
    <link href="http://yoursite.com/2020/08/24/character-sets-and-character-encoding/"/>
    <id>http://yoursite.com/2020/08/24/character-sets-and-character-encoding/</id>
    <published>2020-08-24T02:40:50.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>介绍如下几种概念</p><ul><li>字符集<ul><li>Unicode</li><li>GB2312</li><li>GB18030</li></ul></li><li>字符编码<ul><li>UTF-8</li><li>UTF-16LE</li><li>UTF-16BE</li></ul></li><li>字库</li></ul><a id="more"></a><h2 id="Character-Sets"><a href="#Character-Sets" class="headerlink" title="Character Sets"></a>Character Sets</h2><p>字符集是标准，是一个系统支持字符的集合，包括通用和地区性标准，例如</p><ul><li><a href="https://zh.wikipedia.org/wiki/Unicode" target="_blank" rel="noopener">Unicode</a></li><li><a href="https://zh.wikipedia.org/wiki/GB_2312" target="_blank" rel="noopener">GB2312</a></li><li>iso8859</li><li><a href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A0%81%E9%A1%B5" target="_blank" rel="noopener">Code Page</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%A4%A7%E4%BA%94%E7%A2%BC" target="_blank" rel="noopener">Big5</a></li><li><a href="https://zh.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">ASCII</a></li></ul><h2 id="Character-Encoding"><a href="#Character-Encoding" class="headerlink" title="Character Encoding"></a>Character Encoding</h2><p>字符集是字符的集合，字符编码用于定于字符集中的字符如何编码为特定的二进制数据，以便于在计算机中存储，<strong>是定义在字符集上的映射规则</strong></p><ul><li><a href="https://zh.wikipedia.org/wiki/UTF-8" target="_blank" rel="noopener">UTF-8</a></li><li><a href="https://zh.wikipedia.org/wiki/UTF-16" target="_blank" rel="noopener">UTF-16</a></li><li><a href="https://zh.wikipedia.org/wiki/GB_2312" target="_blank" rel="noopener">GB2312</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%A4%A7%E4%BA%94%E7%A2%BC" target="_blank" rel="noopener">Big5</a></li><li><a href="https://zh.wikipedia.org/wiki/ASCII" target="_blank" rel="noopener">ASCII</a></li></ul><blockquote><p>术语字符编码（character encoding），字符映射（character map），字符集（character set）或者代码页，在历史上往往是同义概念，即字符表（repertoire）中的字符如何编码为码元的流（stream of code units）–通常每个字符对应单个码元。</p></blockquote><h2 id="字库"><a href="#字库" class="headerlink" title="字库"></a>字库</h2><p>所有可读或可显示字符的数据库，是信息的集合</p><h2 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h2><ul><li>字库，决定了整个字符集能够展现表示的所有字符的范围</li><li>字符集，用一个编码值<code>code point</code>来表示一个字符，这个值称为字符对应于编码字符集（如：Unicode、ASCII）的序号</li><li>字符编码，是字符集和实际存储数值之间的转换关系。字符，是根据字符编码方案转换为一个二进制数值存储在计算机中</li><li>编码字符集Unicode，有UTF-8、UTF-16、UTF-32、UCS-2、UCS-4等多种字符编码</li><li>编码字符集ASCII，本身就是编码字符集，又是字符编码</li></ul><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ol><li><a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">字符编码笔记：ASCII，Unicode 和 UTF-8</a></li><li><a href="http://cenalulu.github.io/linux/character-encoding/" target="_blank" rel="noopener">十分钟搞清字符集和字符编码</a></li><li><a href="https://my.oschina.net/u/4407987/blog/3319285/print" target="_blank" rel="noopener">Unicode</a></li><li><a href="https://www.cnblogs.com/skynet/archive/2011/05/03/2035105.html#_2.2._GBXXXX%E5%AD%97%E7%AC%A6%E9%9B%86&%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">字符集和字符编码</a></li><li><a href="https://dailc.github.io/2017/05/03/char_charset_charEncoding.html" target="_blank" rel="noopener">字符，字符集，字符编码解惑</a></li><li><a href="https://www.cnblogs.com/malecrab/p/5300503.html" target="_blank" rel="noopener">细说：Unicode, UTF-8, UTF-16, UTF-32, UCS-2, UCS-4</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81" target="_blank" rel="noopener">字符编码</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;介绍如下几种概念&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;字符集&lt;ul&gt;
&lt;li&gt;Unicode&lt;/li&gt;
&lt;li&gt;GB2312&lt;/li&gt;
&lt;li&gt;GB18030&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;字符编码&lt;ul&gt;
&lt;li&gt;UTF-8&lt;/li&gt;
&lt;li&gt;UTF-16LE&lt;/li&gt;
&lt;li&gt;UTF-16BE&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;字库&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Character Encoding/Fonts" scheme="http://yoursite.com/categories/Tools/Character-Encoding-Fonts/"/>
    
    
      <category term="character set" scheme="http://yoursite.com/tags/character-set/"/>
    
      <category term="gb18030" scheme="http://yoursite.com/tags/gb18030/"/>
    
      <category term="character encoding" scheme="http://yoursite.com/tags/character-encoding/"/>
    
      <category term="unicode" scheme="http://yoursite.com/tags/unicode/"/>
    
      <category term="gdb2312" scheme="http://yoursite.com/tags/gdb2312/"/>
    
      <category term="utf-8" scheme="http://yoursite.com/tags/utf-8/"/>
    
      <category term="utf-16" scheme="http://yoursite.com/tags/utf-16/"/>
    
  </entry>
  
  <entry>
    <title>如何检查嵌入式系统内存占用</title>
    <link href="http://yoursite.com/2020/08/11/how-to-check-heap-size/"/>
    <id>http://yoursite.com/2020/08/11/how-to-check-heap-size/</id>
    <published>2020-08-11T07:30:37.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>使用 <code>size</code> 和 <code>nm</code> 分析系统内存开销</p><a id="more"></a><h2 id="I"><a href="#I" class="headerlink" title="I"></a>I</h2><p>应用总内存 = text + data + bss + heap</p><h2 id="size"><a href="#size" class="headerlink" title="size"></a>size</h2><pre><code class="shell">$ size src/out.elf   text       data        bss        dec        hex    filename6148556       3428    3137272    9289256     8dbe28    src/out.elf</code></pre><ul><li>text 代码段</li><li>data 数据段</li><li>bss 未初始化全局变量</li><li>heap 堆内存</li></ul><p>前三部分为静态内存分配</p><h2 id="nm"><a href="#nm" class="headerlink" title="nm"></a>nm</h2><p>使用 <code>nm</code> 分析符号表，找出占用大内存的符号</p><pre><code class="shell">$ nm --print-size --size-sort src/out.elf</code></pre><ul><li><code>b</code> 为局部bss变量</li><li><code>B</code> 为全局bss变量</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用 &lt;code&gt;size&lt;/code&gt; 和 &lt;code&gt;nm&lt;/code&gt; 分析系统内存开销&lt;/p&gt;
    
    </summary>
    
      <category term="C" scheme="http://yoursite.com/categories/C/"/>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Prof" scheme="http://yoursite.com/categories/Tools/Prof/"/>
    
      <category term="GCC" scheme="http://yoursite.com/categories/C/GCC/"/>
    
    
      <category term="nm" scheme="http://yoursite.com/tags/nm/"/>
    
      <category term="size" scheme="http://yoursite.com/tags/size/"/>
    
      <category term="bss" scheme="http://yoursite.com/tags/bss/"/>
    
  </entry>
  
  <entry>
    <title>分析 ELF 段和符号大小</title>
    <link href="http://yoursite.com/2020/07/31/how-to-analyze-size-of-ELF-sections-and-symbol/"/>
    <id>http://yoursite.com/2020/07/31/how-to-analyze-size-of-ELF-sections-and-symbol/</id>
    <published>2020-07-31T06:55:21.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>使用工具分析 ELF 以了解内存占用</p><ul><li>nm</li><li>size</li><li>readelf</li></ul><a id="more"></a><h2 id="nm"><a href="#nm" class="headerlink" title="nm"></a>nm</h2><pre><code class="shell">$ nm --print-size --size-sort a.out$ nm --print-size --size-sort --radix=d a.out</code></pre><h2 id="size"><a href="#size" class="headerlink" title="size"></a>size</h2><pre><code class="shell">$ size a.out   text       data        bss        dec        hex    filename   1900        628         16       2544        9f0    a.out$ size -A -d a.out</code></pre><h2 id="readelf"><a href="#readelf" class="headerlink" title="readelf"></a>readelf</h2><pre><code class="shell">$ readelf -e a.out</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用工具分析 ELF 以了解内存占用&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nm&lt;/li&gt;
&lt;li&gt;size&lt;/li&gt;
&lt;li&gt;readelf&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="C" scheme="http://yoursite.com/categories/C/"/>
    
      <category term="Linker" scheme="http://yoursite.com/categories/C/Linker/"/>
    
    
      <category term="nm" scheme="http://yoursite.com/tags/nm/"/>
    
      <category term="size" scheme="http://yoursite.com/tags/size/"/>
    
  </entry>
  
  <entry>
    <title>如何调试嵌入式系统</title>
    <link href="http://yoursite.com/2020/07/23/how-to-debug-an-embedded-system/"/>
    <id>http://yoursite.com/2020/07/23/how-to-debug-an-embedded-system/</id>
    <published>2020-07-23T01:50:47.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>嵌入式系统调试的两种方式：</p><ul><li>Software Debugger<ul><li>gdbserver</li><li>redboot</li></ul></li><li>Hardware Debugger<ul><li>jtag</li><li>swd</li><li>jlink</li></ul></li></ul><a id="more"></a><h2 id="Software-Debugger"><a href="#Software-Debugger" class="headerlink" title="Software Debugger"></a>Software Debugger</h2><p><img src="/images/gnu/1595471565914.png" alt="gdbserver典型应用场景"></p><ul><li><code>gdb</code> 运行于宿主机</li><li><code>gdbserver</code> 运行于目标机，核心依赖于 <code>ptrace</code>，是轻量级的GDB调试器，担任着调试代理的角色</li><li>使用网口/串口连接通信</li></ul><p><img src="/images/gnu/1595471933130.png" alt="本地调试与远程调试"></p><h3 id="gdbserver"><a href="#gdbserver" class="headerlink" title="gdbserver"></a>gdbserver</h3><h3 id="redboot"><a href="#redboot" class="headerlink" title="redboot"></a>redboot</h3><p>eCos redboot 包含有 <code>GDB stub</code>，可当作 <code>GDB Server</code> 用</p><h2 id="Hardware-Debugger"><a href="#Hardware-Debugger" class="headerlink" title="Hardware Debugger"></a>Hardware Debugger</h2><p><img src="/images/gnu/1595471003633.png" alt="jtag典型应用场景"></p><ul><li><code>gdb</code> 运行于宿主机</li><li>需要硬件仿真器</li><li>需要芯片支持</li></ul><h2 id="OpenOCD"><a href="#OpenOCD" class="headerlink" title="OpenOCD"></a>OpenOCD</h2><p>OpenOCD（Open On-Chip Debugger）开源片上调试器，<strong>是一款开源软件</strong>。旨在提供针对嵌入式设备的调试、系统编程和边界扫描功能。是在仿真器的辅助下完成的，仿真器是能够提供调试目标的电信号的小型硬件单元。<strong>仿真器是必须的</strong>，因为宿主机通常不具备这种电信号的直接解析功能。</p><p><img src="/images/gnu/1595472703759.png" alt="1595472703759"></p><p><img src="/images/gnu/1595473016901.png" alt="1595473016901"></p><p>分为三部分，详见<a href="https://www.slideshare.net/linaroorg/hkg18403-introducing-openocd-status-of-openocd-on-aarch64" target="_blank" rel="noopener">Introducing OpenOCD: Status of OpenOCD on AArch64</a>：</p><ul><li>Development Hardware</li><li>Debug Adapter</li><li>Host Computer</li></ul><h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><ol><li>Linux<ul><li>使用 JTAG 仿真器调试 Linux 内核</li><li>使用 gdbserver 调试 Linux 应用</li><li>同时使用</li><li><a href="https://blog.csdn.net/yifeng_1118/article/details/66480266" target="_blank" rel="noopener">JTAG调试内核和gdbserver冲突问题</a></li></ul></li><li>eCos<ul><li>使用 JTAG 仿真器调试，带有硬件断点/watch</li><li>使用 RedBoot 调试</li></ul></li><li>OpenOCD<ul><li>JTAG ?</li><li>SWD ?</li><li>gdbserver ?</li></ul></li></ol><h2 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h2><ol><li><a href="https://www.cnblogs.com/ccxikka/p/10519518.html" target="_blank" rel="noopener">gdb调试原理及qemu中的gdbserver</a></li><li><a href="https://stackoverflow.com/questions/13496389/gdb-remote-protocol-how-to-analyse-packets" target="_blank" rel="noopener">GDB remote protocol: how to analyse packets?</a></li><li><a href="https://doc.ecoscentric.com/cdt-guide/ch-debug.html" target="_blank" rel="noopener">Debugging eCos applications</a></li><li><a href="https://en.wikipedia.org/wiki/Gdbserver" target="_blank" rel="noopener">gdbserver</a></li><li><a href="https://blog.csdn.net/LEON1741/article/details/72846434" target="_blank" rel="noopener">浅论各种调试接口的区别</a></li><li><a href="https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32/api-guides/jtag-debugging/index.html#" target="_blank" rel="noopener">OpenOCD JTAG 调试</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;嵌入式系统调试的两种方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Software Debugger&lt;ul&gt;
&lt;li&gt;gdbserver&lt;/li&gt;
&lt;li&gt;redboot&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Hardware Debugger&lt;ul&gt;
&lt;li&gt;jtag&lt;/li&gt;
&lt;li&gt;swd&lt;/li&gt;
&lt;li&gt;jlink&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="GDB" scheme="http://yoursite.com/categories/Tools/GDB/"/>
    
    
      <category term="gdb" scheme="http://yoursite.com/tags/gdb/"/>
    
      <category term="jtag" scheme="http://yoursite.com/tags/jtag/"/>
    
      <category term="gdbserver" scheme="http://yoursite.com/tags/gdbserver/"/>
    
      <category term="jlink" scheme="http://yoursite.com/tags/jlink/"/>
    
      <category term="swd" scheme="http://yoursite.com/tags/swd/"/>
    
      <category term="openocd" scheme="http://yoursite.com/tags/openocd/"/>
    
  </entry>
  
  <entry>
    <title>如何正确拷贝字符串</title>
    <link href="http://yoursite.com/2020/07/20/how-to-copy-string-correctly/"/>
    <id>http://yoursite.com/2020/07/20/how-to-copy-string-correctly/</id>
    <published>2020-07-20T02:23:56.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<ul><li>strcpy</li><li>strncpy</li><li>memcpy</li><li>snprintf</li><li>strlen</li><li>sizeof</li></ul><p>正确无隐患拷贝字符串</p><a id="more"></a><h2 id="strlen"><a href="#strlen" class="headerlink" title="strlen"></a>strlen</h2><p><code>strlen</code> 运行时计算字符串长度，当字符数组中不存在 <code>\0</code> 时，计算错误</p><h2 id="sizeof"><a href="#sizeof" class="headerlink" title="sizeof"></a>sizeof</h2><p><code>sizeof</code> 编译时计算分配空间，字符数组大小</p><h2 id="strcpy"><a href="#strcpy" class="headerlink" title="strcpy"></a>strcpy</h2><pre><code class="c">    char *strcpy(char *dest, const char *src);</code></pre><p><code>strcpy</code> 提供字符串的复制，只用于字符串复制，会复制字符串的结束符。不需要指定长度，它遇到被复制字符的串结束符 <code>\0</code> 才结束，所以容易溢出</p><h2 id="strncpy"><a href="#strncpy" class="headerlink" title="strncpy"></a>strncpy</h2><pre><code class="c">    char *strncpy(char *dest, const char *src, size_t n);</code></pre><p><code>strncpy</code> 把src所指由 <code>\0</code> 结束的字符串的前n个字节复制到dest所指的数组中</p><ul><li>如果src的前n个字节不含 <code>\0</code> 字符，则结果不会以 <code>\0</code> 字符结束，<strong>对dest进行字符串运行会导致出错</strong></li><li>如果src的长度小于n个字节，则以 <code>\0</code> 填充dest直到复制完n个字节，<strong>效率低下</strong></li><li>src和dest所指内存区域不可以重叠且dest必须有足够的空间来容纳src的字符串</li></ul><p><code>strncpy</code> 正确用法</p><pre><code class="c">// solution Achar dest[MAX];strncpy(dest, src, sizeof(dest)-1);dest[MAX-1] = &#39;\0&#39;;// solution Bchar dest[MAX];memset(dest, 0, sizeof(dest));strncpy(dest, src, sizeof(dest)-1);</code></pre><h2 id="正确用法"><a href="#正确用法" class="headerlink" title="正确用法"></a>正确用法</h2><ul><li>通用用法：<code>snprintf</code></li><li>性能用法：<code>memcpy</code></li></ul><h3 id="snprintf"><a href="#snprintf" class="headerlink" title="snprintf"></a>snprintf</h3><pre><code class="c">int snprintf(char *str, size_t size, const char *format, ...);</code></pre><p>使用 <code>snprintf</code> 进行字符串拷贝，防止溢出，<code>snprintf</code> 会把buf的最后一个位置保留为 <code>\0</code></p><pre><code class="c">snprintf(dest, sizeof(dest), &quot;%s&quot;, src);</code></pre><blockquote><p>当 src 长度远大于 dest 时，由于 <code>snprintf</code> 要返回 src 的字节数，需要扫描 src，会产生性能损失</p></blockquote><h3 id="memcpy"><a href="#memcpy" class="headerlink" title="memcpy"></a>memcpy</h3><pre><code class="c">void *memcpy(void *dest, const void *src, size_t n);</code></pre><p><code>memcpy</code> 提供了一般内存的复制，对于需要复制的内容没有限制。需要考虑字符串拷贝性能时使用 <code>strlen</code> + <code>memcpy</code></p>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;strcpy&lt;/li&gt;
&lt;li&gt;strncpy&lt;/li&gt;
&lt;li&gt;memcpy&lt;/li&gt;
&lt;li&gt;snprintf&lt;/li&gt;
&lt;li&gt;strlen&lt;/li&gt;
&lt;li&gt;sizeof&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;正确无隐患拷贝字符串&lt;/p&gt;
    
    </summary>
    
      <category term="C" scheme="http://yoursite.com/categories/C/"/>
    
      <category term="Functions" scheme="http://yoursite.com/categories/C/Functions/"/>
    
    
      <category term="c" scheme="http://yoursite.com/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>eCos 组件初始化</title>
    <link href="http://yoursite.com/2020/07/11/ecos-component-initialization/"/>
    <id>http://yoursite.com/2020/07/11/ecos-component-initialization/</id>
    <published>2020-07-11T02:57:29.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>eCos 组件注册及初始化</p><a id="more"></a><h2 id="eCos-组件初始化机制"><a href="#eCos-组件初始化机制" class="headerlink" title="eCos 组件初始化机制"></a>eCos 组件初始化机制</h2><blockquote><p>eCos 组件初始化利用了 C++ 静态对象实例初始化的机制</p></blockquote><p>C++ 对象在初始化时将会调用该对象类的构造函数来初始化对象</p><ul><li>对象在函数内声明，那么函数执行到对象的声明处调用类构造函数来初始化对象</li><li>对象在函数外声明，也就是<strong>将对象声明为全局对象或静态对象</strong>，那么编译器会将该对象的初始化代码地址（函数指针）写到名为 <code>.ctors</code> 节，普通程序在进入 main 函数前由操作系统的运行时库调用存储在 <code>.ctors</code> 中的函数指针列表来初始化全局或静态对象</li></ul><p>eCos HAL将调用 <code>cyg_hal_invoke_constructors</code> 函数，该函数调用存储在 <code>.ctors</code> 节中的初始化代码</p><h2 id="组件初始化"><a href="#组件初始化" class="headerlink" title="组件初始化"></a>组件初始化</h2><p>IO 组件</p><pre><code class="cxx">externC void cyg_io_init(void);class cyg_io_init_class {public:    cyg_io_init_class(void) {        cyg_io_init();    }};// And here&#39;s an instance of the class just to make the code runstatic cyg_io_init_class _cyg_io_init CYGBLD_ATTRIB_INIT_PRI(CYG_INIT_IO);</code></pre><h2 id="初始化顺序"><a href="#初始化顺序" class="headerlink" title="初始化顺序"></a>初始化顺序</h2><blockquote><p>初始化过程需要按照一定的次序进行。次序由 <code>CYGBLD_ATTRIB_INIT_PRI</code> 宏指定，该宏带有一个参数，该参数数值越小，那么越早调用该实例的初始化代码</p></blockquote><p>例如 <code>CYGBLD_ATTRIB_INIT_PRI(CYG_INIT_IO)</code> 展开为 <code>__attribute__((init_priority(49000)))</code></p><h2 id="组件注册"><a href="#组件注册" class="headerlink" title="组件注册"></a>组件注册</h2><p>组件定义</p><pre><code class="cxx">#define MOD_IRR         cyg_irr_init_class        irr0       CYGBLD_ATTRIB_INIT_PRI( 60100 );</code></pre><h2 id="检查初始化代码"><a href="#检查初始化代码" class="headerlink" title="检查初始化代码"></a>检查初始化代码</h2><p>符号前缀 <code>_GLOBAL__sub_I</code> 表示这是静态对象初始化代码，符号中间部分的数字决定初始化次序</p><pre><code class="shell">$ nm src/out.elf | grep &quot;t _GLOBAL&quot;90039370 t _GLOBAL__D.11000_cyg_scheduler_sched_lock900389a8 t _GLOBAL__D.12000__ZN13Cyg_Interrupt15disable_counterE90070830 t _GLOBAL__D.14000__ZN9Cyg_Clock15real_time_clockE90038704 t _GLOBAL__D.24100__ZN18Cyg_HardwareThread12thread_entryEP10Cyg_Thread904382d8 t _GLOBAL__D.50000_cyg_mtab_extra90045898 t _GLOBAL__D.50000_cyg_nstab_init90044c60 t _GLOBAL__D.50000_cyg_timeval_to_ticks900722b0 t _GLOBAL__D.50000_fdlock90071cc0 t _GLOBAL__D.56000_cyg_libc_stdio_stdin9003c6b0 t _GLOBAL__D.56000_strtok9003ccd8 t _GLOBAL__D.56000__ZN20Cyg_libc_stdio_files5filesE9003d1b8 t _GLOBAL__D.56001_cyg_libc_stdio_stdout90071ba0 t _GLOBAL__D.56002_cyg_libc_stdio_stderr9006b878 t _GLOBAL__D.58000_cyg_timespec_to_ticks9006b5f4 t _GLOBAL__D.58000_pthread_mutex9006bf64 t _GLOBAL__D.58000_signal_mutex90039358 t _GLOBAL__I.11000_cyg_scheduler_sched_lock90038738 t _GLOBAL__I.12000__Z26cyg_null_exception_handlerjij90038998 t _GLOBAL__I.12000__ZN13Cyg_Interrupt15disable_counterE90070818 t _GLOBAL__I.14000__ZN9Cyg_Clock15real_time_clockE900386ec t _GLOBAL__I.24100__ZN18Cyg_HardwareThread12thread_entryEP10Cyg_Thread9006c110 t _GLOBAL__I.32000__ZN12cyg_i2c_initC2Ev90042c38 t _GLOBAL__I.36000__ZN13Cyg_WallClock9wallclockE903e18ec t _GLOBAL__I.48000_char_dev_register90436564 t _GLOBAL__I.49000_ioinit.cxx904382c0 t _GLOBAL__I.50000_cyg_mtab_extra90045880 t _GLOBAL__I.50000_cyg_nstab_init90044c48 t _GLOBAL__I.50000_cyg_timeval_to_ticks90072298 t _GLOBAL__I.50000_fdlock90071ca8 t _GLOBAL__I.56000_cyg_libc_stdio_stdin9003c698 t _GLOBAL__I.56000_strtok9003ccc0 t _GLOBAL__I.56000__ZN20Cyg_libc_stdio_files5filesE9003d1a0 t _GLOBAL__I.56001_cyg_libc_stdio_stdout90071b88 t _GLOBAL__I.56002_cyg_libc_stdio_stderr9006b860 t _GLOBAL__I.58000_cyg_timespec_to_ticks9006b5dc t _GLOBAL__I.58000_pthread_mutex9006bf4c t _GLOBAL__I.58000_signal_mutex903e1100 t _GLOBAL__I.58000_startup.cxx904554ac t _GLOBAL_OFFSET_TABLE_</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;eCos 组件注册及初始化&lt;/p&gt;
    
    </summary>
    
      <category term="eCos" scheme="http://yoursite.com/categories/eCos/"/>
    
    
      <category term="ecos" scheme="http://yoursite.com/tags/ecos/"/>
    
  </entry>
  
  <entry>
    <title>匿名联合体和匿名结构体</title>
    <link href="http://yoursite.com/2020/06/10/anonymous-union-and-anonymous-struct/"/>
    <id>http://yoursite.com/2020/06/10/anonymous-union-and-anonymous-struct/</id>
    <published>2020-06-10T11:52:20.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>编译出错：</p><pre><code>main.c:9:16: error: ‘struct channel::&lt;unnamed union&gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct dvb {                ^~~</code></pre><a id="more"></a><h2 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h2><pre><code class="c">#include &lt;string.h&gt;struct channel {    int id;    unsigned int services_num;    int *services;    unsigned char delivery;    union {        struct dvb {            int onid;            int tsid;            int sid;        } dvb;        struct ott {            int backendid;            int channelid;        } ott;    };} ch;int main(void){    memset(&amp;ch, 0, sizeof(struct channel));}</code></pre><p>编译</p><pre><code class="bash">$ gcc main.c$ g++ main.cmain.c:9:16: error: ‘struct channel::&lt;unnamed union&gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct dvb {                ^~~main.c:15:16: error: ‘struct channel::&lt;unnamed union&gt;::ott’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct ott {                ^~~$ g++ -fpermissive main.cmain.c:9:16: warning: ‘struct channel::&lt;unnamed union&gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct dvb {                ^~~main.c:15:16: warning: ‘struct channel::&lt;unnamed union&gt;::ott’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct ott {                ^~~</code></pre><h2 id="solutions"><a href="#solutions" class="headerlink" title="solutions"></a>solutions</h2><h3 id="I"><a href="#I" class="headerlink" title="I"></a>I</h3><p>增加编译选项 <code>-fpermissive</code></p><pre><code class="bash">$ gcc main.c$ g++ main.cmain.c:10:16: warning: ‘struct channel::&lt;unnamed union&gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct dvb {                ^~~main.c:16:16: warning: ‘struct channel::&lt;unnamed union&gt;::ott’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct ott {                ^~~</code></pre><h3 id="II"><a href="#II" class="headerlink" title="II"></a>II</h3><p>增加 <code>union</code> 成员 <code>u</code></p><pre><code>struct channel {    int id;    unsigned int services_num;    int *services;    unsigned char delivery;    union {        struct dvb {            int onid;            int tsid;            int sid;        } dvb;        struct ott {            int backendid;            int channelid;        } ott;    } u;} ch;</code></pre><pre><code class="bash">$ gcc main.c$ g++ main.c</code></pre><h3 id="III"><a href="#III" class="headerlink" title="III"></a>III</h3><p>修改匿名 <code>union</code> 内部结构体为匿名</p><pre><code>struct channel {    int id;    unsigned int services_num;    int *services;    unsigned char delivery;    union {        struct {            int onid;            int tsid;            int sid;        };        struct {            int backendid;            int channelid;        };    };} ch;</code></pre><p>或者</p><pre><code>struct channel {    int id;    unsigned int services_num;    int *services;    unsigned char delivery;    union {        struct {            int onid;            int tsid;            int sid;        } dvb;        struct {            int backendid;            int channelid;        } ott;    };} ch;</code></pre><pre><code class="bash">$ gcc main.c$ g++ main.c</code></pre><h3 id="IV"><a href="#IV" class="headerlink" title="IV"></a>IV</h3><p>修改为如下同样存在问题，这种方式是一种错误，定义了 <code>struct dvb</code> 类型，但是没有定义属于该类型的任何对象</p><pre><code>struct channel {    int id;    unsigned int services_num;    int *services;    unsigned char delivery;    union {        struct dvb {            int onid;            int tsid;            int sid;        };        struct ott {            int backendid;            int channelid;        };    };} ch;</code></pre><pre><code class="bash">$ gcc main.cmain.c:13:10: warning: declaration does not declare anything         };          ^main.c:18:10: warning: declaration does not declare anything         };          ^$ g++ main.cmain.c:9:16: error: ‘struct channel::&lt;unnamed union&gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct dvb {                ^~~main.c:15:16: error: ‘struct channel::&lt;unnamed union&gt;::ott’ invalid; an anonymous union can only have non-static data members [-fpermissive]         struct ott {                ^~~</code></pre><h2 id="C-union-特点"><a href="#C-union-特点" class="headerlink" title="C++ union 特点"></a>C++ <code>union</code> 特点</h2><blockquote><p>C++ 联合体中不能包含非基本类型成员变量，原因好像是因为非基本类型存在构造函数（包括默认构造函数）为了避免多层嵌套后结构的安全性</p></blockquote><p>C++ 中 <code>union</code> 里面需要的成员需要共享内存，因此<strong>静态</strong>和<strong>引用</strong>都不能用，因为他们不可能共享内存</p><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><ol><li><a href="https://www.javatt.com/p/37232" target="_blank" rel="noopener">例解 C 语言中的匿名联合体和匿名结构体</a></li><li><a href="https://en.it1352.com/article/e4fdc90b62f14d0abaf6f46a4f4ea97e.html" target="_blank" rel="noopener">anonymous union can only have non-static data members GCC c</a></li><li><a href="https://stackoverflow.com/questions/17637392/anonymous-union-can-only-have-non-static-data-members-gcc-c" target="_blank" rel="noopener">anonymous union can only have non-static data members GCC c++</a></li><li><a href="https://stackoverflow.com/questions/2253878/why-does-c-disallow-anonymous-structs" target="_blank" rel="noopener">Why does C++ disallow anonymous structs?</a></li><li><a href="https://stackoverflow.com/questions/25542390/anonymous-union-and-struct" target="_blank" rel="noopener">Anonymous union and struct</a></li><li><a href="https://www.cnblogs.com/LubinLew/p/struct_enum_union_in_cpp.html" target="_blank" rel="noopener">C++对C语言的结构、联合、枚举 这3种数据类型进行了扩展</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;编译出错：&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;main.c:9:16: error: ‘struct channel::&amp;lt;unnamed union&amp;gt;::dvb’ invalid; an anonymous union can only have non-static data members [-fpermissive]
         struct dvb {
                ^~~&lt;/code&gt;&lt;/pre&gt;
    
    </summary>
    
      <category term="C" scheme="http://yoursite.com/categories/C/"/>
    
      <category term="GCC" scheme="http://yoursite.com/categories/C/GCC/"/>
    
    
      <category term="union" scheme="http://yoursite.com/tags/union/"/>
    
      <category term="struct" scheme="http://yoursite.com/tags/struct/"/>
    
  </entry>
  
  <entry>
    <title>Pandas 数据选择</title>
    <link href="http://yoursite.com/2020/06/05/pandas-data-selection/"/>
    <id>http://yoursite.com/2020/06/05/pandas-data-selection/</id>
    <published>2020-06-05T02:17:48.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>Pandas 数据选择</p><ul><li><code>.loc</code> <code>.iloc</code></li><li><code>.at</code> <code>.iat</code></li><li><code>[]</code></li><li><code>.attr</code></li></ul><a id="more"></a><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E7%B4%A2%E5%BC%95%E7%9A%84%E4%B8%8D%E5%90%8C%E9%80%89%E6%8B%A9" target="_blank" rel="noopener">索引的不同选择</a></p><blockquote><p>标量：相对于矢量，只有大小没有方向的数值。比如 39.343434<br>向量：矢量，既有方向，也有大小的一组数值。数据表里的一行数据，或者一列数据都可以是向量。比如 DataFrame 中的一行或者一列</p></blockquote><h2 id="loc"><a href="#loc" class="headerlink" title=".loc"></a><code>.loc</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E6%8C%89%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9" target="_blank" rel="noopener">按标签选择</a></p><blockquote><p><code>loc</code> 返回对象降维，<code>dataframe</code> -&gt; <code>series</code> -&gt; <code>标量</code><br>切片端点包含</p></blockquote><p>不同对象类型：</p><ul><li>series: <code>s.loc[indexer]</code></li><li>dataframe: <code>df.loc[row_indexer,column_indexer]</code></li></ul><p>常用方式：</p><ul><li><code>df.loc[&#39;a&#39;]</code><blockquote><p><code>a</code> 为 index label，此处输入不是索引的整数位置</p></blockquote></li><li><code>df.loc[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</code></li><li><code>df.loc[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], :]</code></li><li><code>df.loc[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;A&#39;:]]</code></li><li><code>s.loc[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</code></li><li><code>df.loc[&#39;b&#39;:]</code></li><li><code>df.loc[&#39;b&#39;:&#39;d&#39;]</code><blockquote><p>包括行 <code>b</code> 和 <code>d</code></p></blockquote></li><li><code>df.loc[:, &#39;B&#39;:&#39;D&#39;]</code></li><li><code>df.loc[:, [&#39;B&#39;, &#39;D&#39;]]</code></li><li><code>df.loc[df.A &gt; 0]</code></li><li><code>df.loc[df.index.isin([&#39;a&#39;, &#39;b&#39;])]</code></li><li><code>df.loc[df.index == &#39;a&#39;]</code></li><li><code>df.loc[(df[&#39;date&#39;] &gt; &#39;2019-12&#39;) &amp; (df[&#39;date&#39;] &lt; &#39;2020-05&#39;)]</code></li><li><code>df.loc[lambda x: x[&#39;date&#39;] &gt; &#39;2019-12&#39;]</code></li><li><code>df.loc[:, lambda df: [&#39;A&#39;, &#39;B&#39;]]</code></li></ul><h2 id="iloc"><a href="#iloc" class="headerlink" title=".iloc"></a><code>.iloc</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E6%8C%89%E4%BD%8D%E7%BD%AE%E9%80%89%E6%8B%A9" target="_blank" rel="noopener">按位置选择</a></p><blockquote><p><code>iloc</code> 返回对象降维，<code>dataframe</code> -&gt; <code>series</code> -&gt; <code>标量</code><br>切片时，开始包括，而上限是排除<br>纯粹基于整数</p></blockquote><p>不同对象类型：</p><ul><li>series: <code>s.iloc[indexer]</code></li><li>dataframe: <code>df.iloc[row_indexer,column_indexer]</code></li></ul><p>常用方式：</p><ul><li><code>df.iloc[3]</code></li><li><code>df.iloc[1, 1]</code></li><li><code>df.iloc[[3, 4, 5]]</code></li><li><code>df.iloc[[3, 4, 5], :]</code></li><li><code>df.iloc[4:]</code></li><li><code>df.iloc[4:5]</code><blockquote><p>包含行4，不包含行5</p></blockquote></li><li><code>df.iloc[:, 4:5]</code></li><li><code>df.iloc[:, [4, 5]]</code></li><li><code>df.iloc[[1, 3, 5], [1, 3]]</code></li><li><code>df.iloc[[1, 3, 5], [1:3]]</code></li><li><code>df.iloc[list(df.A&lt;0)]</code> 或 <code>df.iloc[np.array(df.A&lt;0)]</code></li><li><code>df.iloc[df.index.isin([&#39;a&#39;, &#39;c&#39;])]</code></li><li><code>df.loc[df.index == &#39;a&#39;]</code></li><li><code>df.iloc[:, lambda df: [0, 1]]</code></li></ul><h2 id="at-和-iat"><a href="#at-和-iat" class="headerlink" title=".at 和 .iat"></a><code>.at</code> 和 <code>.iat</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E5%BF%AB%E9%80%9F%E6%A0%87%E9%87%8F%E5%80%BC%E8%8E%B7%E5%8F%96%E5%92%8C%E8%AE%BE%E7%BD%AE" target="_blank" rel="noopener">快速标量值获取和设置</a></p><p><code>at</code> 提供基于标签的标量查找，同时 <code>iat</code> 提供类似于基于整数的查找 <code>iloc</code></p><ul><li><code>df.at[&#39;b&#39;, &#39;B&#39;]</code></li><li><code>df.iat[1, 1]</code></li></ul><h2 id=""><a href="#" class="headerlink" title="[]"></a><code>[]</code></h2><p><strong>只能输入一个维度，不能用逗号隔开输入两个维度</strong></p><p>切片操作，语法与 ndarray 完全一样，返回值的一部分和相应的标签</p><ul><li><code>s[:5]</code></li><li><code>s[::-1]</code></li><li><code>s[::2]</code></li><li><code>df[:3]</code></li><li><code>df[2:3]</code></li><li><code>df[::-1]</code></li><li><code>df[[&#39;A&#39;, &#39;B&#39;, &#39;D&#39;]]</code></li><li><code>df[&#39;A&#39;]</code></li><li><code>df[df.A&lt;0]</code></li></ul><h2 id="attr"><a href="#attr" class="headerlink" title=".attr"></a><code>.attr</code></h2><p>用于访问列</p><ul><li><code>df.A</code></li></ul><h2 id="布尔运算"><a href="#布尔运算" class="headerlink" title="布尔运算"></a>布尔运算</h2><p><strong>必须使用括号进行分组</strong></p><ul><li><code>|</code></li><li><code>&amp;</code></li><li><code>~</code></li></ul><p>例如：</p><ul><li><code>s[(s &lt; -1) | (s &gt; 0.5)]</code></li><li><code>s[~(s &lt; 0)]</code></li></ul><h2 id="isin"><a href="#isin" class="headerlink" title="isin"></a><code>isin</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E4%BD%BF%E7%94%A8isin%E8%BF%9B%E8%A1%8C%E7%B4%A2%E5%BC%95" target="_blank" rel="noopener">使用isin进行索引</a></p><ul><li><code>s.isin([2, 4, 6])</code></li><li><code>s[s.index.isin([2, 4, 6])]</code></li><li><code>s_mi.iloc[s_mi.index.isin([(1, &#39;a&#39;), (2, &#39;b&#39;), (0, &#39;c&#39;)])]</code></li></ul><h2 id="where"><a href="#where" class="headerlink" title="where"></a><code>where</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E8%AF%A5where-%E6%96%B9%E6%B3%95%E5%92%8C%E5%B1%8F%E8%94%BD" target="_blank" rel="noopener">该where()方法和屏蔽</a></p><p><code>where</code> 保证选择输出与原始数据具有相同的形状</p><pre><code class="python">In [16]: s                                                                                                                                              Out[16]: 4    03    12    21    30    4dtype: int64In [17]: s[s &gt; 2]                                                                                                                                       Out[17]: 1    30    4dtype: int64In [18]: s.where(s &gt; 2)                                                                                                                                 Out[18]: 4    NaN3    NaN2    NaN1    3.00    4.0dtype: float64</code></pre><h2 id="query"><a href="#query" class="headerlink" title="query"></a><code>query</code></h2><p><a href="https://www.pypandas.cn/docs/user_guide/indexing.html#%E8%AF%A5query-%E6%96%B9%E6%B3%95" target="_blank" rel="noopener">该query()方法</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Pandas 数据选择&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;.loc&lt;/code&gt; &lt;code&gt;.iloc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.at&lt;/code&gt; &lt;code&gt;.iat&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;.attr&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Python" scheme="http://yoursite.com/categories/Python/"/>
    
      <category term="Pandas" scheme="http://yoursite.com/categories/Python/Pandas/"/>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
      <category term="pandas" scheme="http://yoursite.com/tags/pandas/"/>
    
  </entry>
  
  <entry>
    <title>查找指定 commit 之间修改文件列表</title>
    <link href="http://yoursite.com/2020/05/18/git-diff-between-commits-in-git/"/>
    <id>http://yoursite.com/2020/05/18/git-diff-between-commits-in-git/</id>
    <published>2020-05-18T11:20:28.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>使用 <code>git diff</code> 查看指定 commit 之间修改文件列表</p><a id="more"></a><p>使用 <a href="https://github.com.cnpmjs.org/jingweno/ccat.git" target="_blank" rel="noopener">ccat</a> 为例</p><pre><code>$ git diff --name-only &lt;SHA, tag start&gt; &lt;SHA, tag end&gt;$ git diff --name-status &lt;SHA, tag start&gt; &lt;SHA, tag end&gt;</code></pre><pre><code class="shell">$ git diff --name-only 561b2d4 7cf6d90.travis.ymlREADME.mdcompletion/zsh/_ccat$ git diff --name-status 561b2d4 7cf6d90M       .travis.ymlM       README.mdA       completion/zsh/_ccat</code></pre><p>然后查看文件的具体改动</p><pre><code class="shell">$ git diff 561b2d4 7cf6d90 .travis.ymldiff --git a/.travis.yml b/.travis.ymlindex e4fed32..008ab1c 100644--- a/.travis.yml+++ b/.travis.yml@@ -1,5 +1,8 @@ sudo: false language: go go:-  - 1.8.3+  - 1.8.x+  - 1.9.x+  - 1.10.x+  - 1.11.x script: ./bin/test</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用 &lt;code&gt;git diff&lt;/code&gt; 查看指定 commit 之间修改文件列表&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Git" scheme="http://yoursite.com/categories/Tools/Git/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>git 带有参数的别名</title>
    <link href="http://yoursite.com/2020/05/12/git-advanced-aliases-with-arguments/"/>
    <id>http://yoursite.com/2020/05/12/git-advanced-aliases-with-arguments/</id>
    <published>2020-05-12T01:38:13.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>git 别名以及使用参数相关注意事项</p><a id="more"></a><h2 id="Aliases"><a href="#Aliases" class="headerlink" title="Aliases"></a>Aliases</h2><p><a href="https://git.wiki.kernel.org/index.php/Aliases#Advanced_aliases_with_arguments" target="_blank" rel="noopener">Aliases</a></p><p>git 别名配置在文件 <code>~/.gitconfig</code> 中，存在两种别名</p><ol><li>git 命令别名，内置命令</li><li>非 git 命令别名，使用前缀<code>!</code>，运行在 shell</li></ol><pre><code>[alias]    ci = commit    br = branch    push-view = !sh -c &#39;git origin HEAD:refs/for/$1&#39; -    gitkconflict = !gitk --left-right HEAD...MERGE_HEAD</code></pre><h2 id="Advanced-aliases-with-parameters"><a href="#Advanced-aliases-with-parameters" class="headerlink" title="Advanced aliases with parameters"></a>Advanced aliases with parameters</h2><blockquote><p>Starting with version 1.5.3, git supports appending the arguments to commands prefixed with “!”, too. If you need to perform a reordering, or to use an argument twice, you can use this trick:</p></blockquote><pre><code>[alias]    example = !sh -c &#39;ls $2 $1&#39; -</code></pre><ul><li><code>!</code> 在 shell 中运行</li><li><code>$1</code> 为第一个参数</li></ul><p>另外一种方式，封装为 <code>bash</code> 函数 <code>f</code>：</p><pre><code>[alias]    files = &quot;!f() { git diff --name-status \&quot;$1^\&quot; \&quot;$1\&quot;; }; f&quot;</code></pre><h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><p>调试输出信息</p><pre><code>$ GIT_TRACE=1 git push-view test</code></pre><p>或者使用 <code>gdb</code> 调试</p><pre><code>[alias]    debug = !GIT_PAGER= gdb --args git</code></pre><p>用法 <code>git debug push-view test</code></p><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>定义 gerrit review alias 为</p><pre><code>[alias]  ...  push-for-review = push origin HEAD:refs/for/master  push-for-review-branch = !git push origin HEAD:refs/for/$1  push-as-draft = push origin HEAD:refs/drafts/master  push-as-draft-branch = !git push origin HEAD:refs/drafts/$1  ...</code></pre><p>调试如下</p><pre><code class="shell">$ GIT_TRACE=1 git push-for-review-branch test16:38:33.280667 git.c:344               trace: built-in: git push origin HEAD:refs/for/test testTo ssh://192.168.110.254:29418/misc   d9d506f..20c5d70  test -&gt; test * [new branch]      HEAD -&gt; refs/for/test</code></pre><p>尾巴上多出一个参数导致直接合并，不理解为什么？<code>$@</code> 解析问题？<br><a href="https://stackoverflow.com/questions/3321492/git-alias-with-positional-parameters" target="_blank" rel="noopener">stackoverflow - Git alias with positional parameters</a>解释如下</p><blockquote><p>The sh -c ‘..’ – and f() {..}; f options both cleanly handle the “$@” parameters in different ways (see with GIT_TRACE). Appending “#” to an alias would also allow positional parameters without leaving the trailing ones.</p></blockquote><p>修改为</p><pre><code>[alias]  ...  push-for-review = push origin HEAD:refs/for/master  push-for-review-branch = &quot;!git push origin HEAD:refs/for/$1 #&quot;  push-as-draft = push origin HEAD:refs/drafts/master  push-as-draft-branch = &quot;!git push origin HEAD:refs/drafts/$1 #&quot;  ...</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;git 别名以及使用参数相关注意事项&lt;/p&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Git" scheme="http://yoursite.com/categories/Tools/Git/"/>
    
    
      <category term="shell" scheme="http://yoursite.com/tags/shell/"/>
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
      <category term="alias" scheme="http://yoursite.com/tags/alias/"/>
    
  </entry>
  
  <entry>
    <title>基于 coc.nvim python 补全</title>
    <link href="http://yoursite.com/2020/05/08/coc-python-completion/"/>
    <id>http://yoursite.com/2020/05/08/coc-python-completion/</id>
    <published>2020-05-08T05:35:57.000Z</published>
    <updated>2020-11-05T05:54:55.843Z</updated>
    
    <content type="html"><![CDATA[<p>使用 <code>coc.nvim</code> 配置 python 补全</p><ul><li>coc-jedi</li><li>coc-python <em>配置失败</em></li><li>python LSP <em>配置失败</em></li></ul><a id="more"></a><h2 id="python-LSP"><a href="#python-LSP" class="headerlink" title="python LSP"></a>python LSP</h2><ul><li><a href="https://github.com/neoclide/coc.nvim/wiki/Language-servers" target="_blank" rel="noopener">Python LS</a></li><li><a href="https://github.com/palantir/python-language-server" target="_blank" rel="noopener">python-language-server</a></li></ul><p>需要配置 <code>coc-settings.json</code></p><p><strong>LSP重启5次失败</strong></p><h2 id="coc-python"><a href="#coc-python" class="headerlink" title="coc-python"></a>coc-python</h2><p><strong>推荐使用</strong>，<code>coc-settings.json</code> 中不能配置 <code>LSP</code></p><ul><li><a href="https://github.com/neoclide/coc.nvim/wiki/Language-servers" target="_blank" rel="noopener">Python LS</a></li><li><a href="https://github.com/neoclide/coc-python" target="_blank" rel="noopener">coc-python</a></li></ul><p>支持两种：</p><ol><li>jedi (工作不正常)</li><li>MPLS (网络原因，不能正常下载)</li></ol><h2 id="coc-jedi"><a href="#coc-jedi" class="headerlink" title="coc-jedi"></a>coc-jedi</h2><ul><li><a href="https://github.com/neoclide/coc.nvim/wiki/Using-coc-extensions" target="_blank" rel="noopener">coc-extensions</a></li><li><a href="https://github.com/pappasam/coc-jedi" target="_blank" rel="noopener">coc-jedi</a></li><li><a href="https://github.com/pappasam/jedi-language-server" target="_blank" rel="noopener">jedi-language-server</a></li></ul><p><strong>与 <code>coc-python</code> 冲突，需要先卸载</strong>，基于 <code>jedi-language-server</code></p><pre><code class="shell">$ python3 -m pip install --user pipx$ pipx install jedi-language-server</code></pre><p><code>coc-settings.json</code> 配置如下</p><pre><code class="json">  &quot;jedi.enable&quot;: true,  &quot;jedi.trace.server&quot;: &quot;messages&quot;,  &quot;jedi.diagnostics.enable&quot;: true,  &quot;jedi.diagnostics.didOpen&quot;: true,  &quot;jedi.diagnostics.didChange&quot;: true,  &quot;jedi.diagnostics.didSave&quot;: true</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用 &lt;code&gt;coc.nvim&lt;/code&gt; 配置 python 补全&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;coc-jedi&lt;/li&gt;
&lt;li&gt;coc-python &lt;em&gt;配置失败&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;python LSP &lt;em&gt;配置失败&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="Tools" scheme="http://yoursite.com/categories/Tools/"/>
    
      <category term="Editor" scheme="http://yoursite.com/categories/Tools/Editor/"/>
    
    
      <category term="lsp" scheme="http://yoursite.com/tags/lsp/"/>
    
      <category term="coc" scheme="http://yoursite.com/tags/coc/"/>
    
      <category term="jedi" scheme="http://yoursite.com/tags/jedi/"/>
    
  </entry>
  
</feed>
